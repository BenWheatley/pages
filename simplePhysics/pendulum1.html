<!-- Matthias MÃ¼ller -->

<!DOCTYPE html>
<html>

<style>
body {
	padding: 10px 50px;
	font-family: verdana; 
	line-height: 1.5;
	font-size: 15px;
}
</style>

<title>Pendulum 1</title>
<body>

<h1>Pendulum 1</h1>

<canvas id="myCanvas" width="600" height="400" style="border:3px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>

<br>

Time step: <input type = "range" min = "0" max = "4" value = "0" id = "timeStepSlider"> <span id = "timeStep">1.0</span> s

<script>

	var timeStep = 0.05;
	var gravity = -10;
	var k = 1000;
	var r = 0.3;
	var startPos = { x : r, y : 0 };
	var startVel = { x : 0, y : 0 };
	
	var ball = {
		pos : startPos,
		vel : startVel,
		radius : 0.05,
		mass : 1
	};
	
	function simulate()
	{
		ball.vel.y += timeStep * gravity;

		var l = Math.sqrt(
			ball.pos.x * ball.pos.x + 
			ball.pos.y * ball.pos.y);
			
		var fx = -k * ball.pos.x / l * (l - r);	
		var fy = -k * ball.pos.y / l * (l - r);	

		ball.vel.x += timeStep * fx / ball.mass;
		ball.vel.y += timeStep * fy / ball.mass;

		ball.pos.x += timeStep * ball.vel.x;
		ball.pos.y += timeStep * ball.vel.y;
	}
	
	function draw() 
	{
		var canvas = document.getElementById("myCanvas");
		var c = canvas.getContext("2d");
		var scale = 600;		
		c.clearRect(0, 0, canvas.width, canvas.height);

		var ox = canvas.width / 2;
		var oy = 20;
		var bx = ox + scale * ball.pos.x;
		var by = oy - scale * ball.pos.y;		
		
		// link
		
		c.strokeStyle = "#000000";
		c.lineWidth = 3;
		
		c.beginPath();
		c.moveTo(ox, oy); c.lineTo(bx, by);
		c.stroke();
		
		// ball
		
		c.fillStyle = "#FF0000";
		c.beginPath();			
		c.arc(bx, by, ball.radius * scale, 0, Math.PI*2, true); 
		c.closePath();
		c.fill();
	}	
		
	var browserTimeStep = 1 / 30;
	var browserTime = 0;

	function step() 
	{
		browserTime += browserTimeStep;
		if (browserTime > timeStep) {
			browserTime = 0;
			
			simulate();		
			draw();
		}
		window.requestAnimationFrame(step);
	}
	
	document.getElementById("timeStepSlider").oninput = function() {
		var steps = [1, 0.5, 0.1, 0.05, 0.01];
		timeStep = steps[Number(this.value)];
		document.getElementById("timeStep").innerHTML = timeStep.toString();
	}
	
	// main
	
	step();

</script> 
</body>
</html>
